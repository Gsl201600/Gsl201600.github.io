---
title: iOS 指针详解
date: 2019-09-25 14:23:00
tags: 代码库
---

1. `指针数组`与`数组指针`
在这里`数组指针`是指向数组的`指针`，其本质为`指针`，指向的对象是`数组`。由于数组的形式多样所以数组指针的表达也十分多样。同理，`指针数组`就是存放指针的`数组`，其本质为`数组`。由于`[ ]`的优先级高于` * `的优先级，`指针数组`与`数组指针`的表达可做如下表示：
```
int * p1 [10];  // 指针数组  p1先与“[ ]”结合构成一个包含10个元素的数组，int*表示的则是数组的内容
int (* p2)[10];  // 数组指针  p2先与“ * ”构成指针定义，int表示数组内容，[10]表示数组内元素个数
```
* 由于`指向数组的指针`与`指向普通整型变量的指针`不同，在这里可以再对`数组名`与`&数组名`的关系进行理解
在一维数组中，`数组名`表示`指向首元素的首地址`，是一个`指向普通变量的指针常量`，当对其+1时偏移量是`一个普通数据类型的内存大小`。而在`数组名前加上取地址符&后`，表示的就是一个`指向数组的指针常量`，对其+1时偏移量是一个`数组的内存大小`

* `int p;` //这是一个普通的`整型变量`
* `int *p;` //首先从`P`处开始,先与`*`结合，所以说明`P`是一个`指针`，然后再与`int`结合，说明指针所指向的内容的类型为`int型`，所以`P`是一个返回`整型数据的指针`
* `int p[3];` //首先从`P`处开始，先与`[]`结合，说明`P`是一个`数组`，然后与`int`结合，说明数组里的元素是`整型的`，所以`P`是一个由`整型数据组成的数组`
* `int *p[3];` //首先从`P`处开始，先与`[]`结合，因为其优先级比`*`高，所以`P`是一个`数组`，然后再与`*`结合，说明数组里的元素是`指针类型`，然后再与`int`结合，说明指针所指向的内容的类型是`整型的`，所以`P`是一个由返回`整型数据的指针所组成的数组`
* `int (*p)[3];` //首先从`P`处开始，先与`*`结合，说明`P`是一个`指针`，然后再与`[]`结合，说明指针所指向的内容是`一个数组`，然后再与`int`结合，说明数组里的元素是`整型的`，所以`P`是一个指向由`整型数据组成的数组的指针`

2. 可以通过如下题目，进一步理解上面的讲解
```
int arrayName[4] = {10, 20, 30, 40};
int *p = (int *)(&arrayName + 1);
NSLog(@"%d", *(p - 1));
```
* 答案解析
> 1. `(&arrayName + 1)`：`&arrayName`是数组的地址（等价于指向`arrayName数组的指针`）
> 2. 增加`1`会往后移动`16个字节`，开始是`4个字节的位置`，移动后就是`16个字节后面的位置`（也就是目前位置是`20个字节`）
> 3. 最后又赋值给`int类型`的指针`p`（`int类型占4个字节`）
> 4. 所以`(p - 1)`就是`减去4个字节`，变成为`16个字节的位置`，输出的`*(p - 1)`值为`40`
